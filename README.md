Τίτλος: Πώς λειτουργεί το “Stock Analysis App” (σύνοψη βημάτων)

1) Εγκαταστάσεις & Βασικές Ρυθμίσεις
   - Το πρόγραμμα φορτώνει βιβλιοθήκες για τιμές μετοχών (yfinance), επεξεργασία (pandas/numpy),
     μηχανική μάθηση (scikit-learn), widgets (ipywidgets) και web (requests/BeautifulSoup).
   - Χρησιμοποιεί ένα μικρό “Calculating…” μήνυμα (spinner) ώστε να βλέπετε ότι η ανάλυση εκτελείται.
   Πού βρίσκεται: imports, ορισμός spinner, ρυθμίσεις warnings.

2) Λήψη Δεδομένων & Τεχνικών Δεικτών  — get_stock_data(...) γραμμές 24–85
   - Κατεβάζει το “μέγιστο διαθέσιμο” ιστορικό (period='max') από το Yahoo Finance.
   - Κρατά έως ~12 χρόνια για ταχύτητα/σταθερότητα.
   - Αν το διαθέσιμο ιστορικό είναι μικρό, εμφανίζει προειδοποίηση αλλά συνεχίζει.
   - Υπολογίζει βασικούς τεχνικούς δείκτες: MA50, MA200, “Volatility” (κυλιόμενη std τιμών),
     Momentum 10 ημερών και RSI.
   - Τραβά επιλεγμένα fundamentals (P/E, EPS, Revenue Growth, Free Cash Flow, ROE, Debt/Equity, Sector, Market Cap).
   - Τα δεδομένα μπαίνουν σε cache ώστε επόμενες αναλύσεις για το ίδιο ticker να είναι γρηγορότερες.
   Πού βρίσκεται: συνάρτηση get_stock_data(...) και υπολογισμός δεικτών.

3) Δείκτης RSI  — compute_rsi(...) γραμμές 87–93
   - Υπολογίζει τον RSI πάνω στη σειρά τιμών για εκτίμηση “υπεραγοράς/υπερπώλησης”.
   Πού βρίσκεται: συνάρτηση compute_rsi(...).

4) Συναισθημα/Ειδήσεις Yahoo  — get_sentiment(...) γραμμές 95–118
   - Ανοίγει τη σελίδα ειδήσεων του Yahoo Finance για το ticker και μετρά το “τόνο”
     των 5 πιο πρόσφατων τίτλων (με TextBlob).
   - Αν αποτύχει ή δεν βρεθούν ειδήσεις, επιστρέφει ουδέτερη τιμή 5.0/10.
   Πού βρίσκεται: συνάρτηση get_sentiment(...).

5) Πραγματικά πρωτοσέλιδα από NewsAPI  — get_news_headlines(...) γραμμές 120–148
   - Ζητά τις πιο πρόσφατες ειδήσεις για την εταιρεία (τίτλος, πηγή, ημερομηνία, link)
     από συγκεκριμένα μέσα μέσω NewsAPI.
   - Αν δεν βρεθούν αποτελέσματα ή υπάρξει πρόβλημα κλειδιού/ορίου, επιστρέφει None.
   Πού βρίσκεται: συνάρτηση get_news_headlines(...).

6) “Ανθεκτικότητα Κλάδου”  — get_sector_resilience(...) γραμμές 150–160
   - Δίνει έναν απλό βαθμό “ανθεκτικότητας” ανά κλάδο (π.χ. Industrials, Tech κ.λπ.)
     που συμμετέχει στο τελικό σκορ.
   Πού βρίσκεται: συνάρτηση get_sector_resilience(...).

7) Προετοιμασία Δεδομένων για Μοντέλο  — prepare_data(...) γραμμές 162–183
   - Φτιάχνει το dataset χαρακτηριστικών: Close, MA50/MA200, Volatility, Momentum, RSI,
     τα fundamentals και (αν υπάρχει) το sentiment.
   - Ορίζει στόχο “Future_Return” ως ποσοστιαία μεταβολή μετά από N χρηματιστηριακές ημέρες
     (N = 21 * μήνες ορίζοντα) και “κόβει” ακραίες τιμές στα ±50%.
   - Αν τα καθαρά δεδομένα είναι λίγα, εμφανίζει προειδοποίηση.
   Πού βρίσκεται: συνάρτηση prepare_data(...).

8) Εκπαίδευση Μοντέλου & Ακρίβεια  — train_model(...) γραμμές 186–218
   - Χωρίζει χρονολογικά τα δεδομένα (80/20) για να αποφευχθεί διαρροή χρόνου (leakage).
   - Κάνει κανονικοποίηση χαρακτηριστικών (StandardScaler).
   - Εκπαιδεύει RandomForest και επιστρέφει Out-of-sample R² (κομμένο στο [0,1]).
   - Αν τα δείγματα είναι πολύ λίγα (< ~80), πετάει ενημερωτικό σφάλμα για ασφάλεια.
   Πού βρίσκεται: συνάρτηση train_model(...).

γραμμές 220–245


9) Κεντρική Αξιολόγηση/Βαθμολόγηση  — evaluate_investment(...) γραμμές 247–405
   - Καλεί τα προηγούμενα (δεδομένα, sentiment, ειδήσεις, prepare, train).
   - Υπολογίζει την τρέχουσα πρόβλεψη (predicted_return) για τον επιλεγμένο ορίζοντα.
   - “Κλιμακώνει” την πρόβλεψη με βάση τη μεταβλητότητα (ώστε το ρίσκο να μετριάζει
     την τελική εκτίμηση) και μετά την “κόβει” στα ±50%.
   - Στήνει ένα σύστημα υπο-βαθμών (Predicted Return, P/E, EPS, Revenue Growth,
     FCF Yield, ROE, Debt/Equity, Sentiment, Model Accuracy, Sector Resilience),
     με βάρη που αθροίζονται σε συνολικό σκορ (0–100) και πρόταση (Sell/Hold/Buy/Strong Buy).
   - Εξηγεί αν το Sentiment έλειπε (και έγιναν αναπροσαρμογές βαρών).
   Πού βρίσκεται: συνάρτηση evaluate_investment(...).

10) Εμφάνιση Αποτελεσμάτων  — display_results(...) γραμμές 407–445
    - Τυπώνει τίτλο με ticker & ορίζοντα, συνολικό σκορ με “αστέρια”, πρόταση,
      “summary table” (τιμή/σκορ/αστέρια/σημείωση) και τα τελευταία πρωτοσέλιδα
      (τίτλος, πηγή, ημερομηνία, σύνδεσμος).
    - Περιλαμβάνει επεξηγηματική σημείωση για το τι σημαίνουν τα αστέρια.
    Πού βρίσκεται: συνάρτηση display_results(...).

11) Διεπαφή Χρήστη & Εκτέλεση γραμμές 471–500
    - Widgets: επιλογή ορίζοντα (1,3,6,12,24 μήνες), πεδίο ticker, κουμπί “Analyze”.
    - Κατά το click: εμφανίζει “Calculating…”, τρέχει ανάλυση και μετά δείχνει τα αποτελέσματα.
    - Τέλος, εμφανίζει τα widgets και την έξοδο (output area) στο Colab.
    Πού βρίσκεται: ορισμοί horizon_dropdown, ticker_input, analyze_button, output
                   και η συνάρτηση on_analyze_button_clicked(...), μαζί με τη display(...).
